{"version":3,"file":"index.js","sources":["../src/PageContext.js","../src/App.js","../src/Link.js","../src/useRemember.js","../src/useForm.js","../src/usePage.js"],"sourcesContent":["import { createContext } from 'react'\n\nconst pageContext = createContext()\npageContext.displayName = 'InertiaPageContext'\n\nexport default pageContext\n","import { Inertia } from '@inertiajs/inertia'\nimport { createElement, useEffect, useState } from 'react'\nimport PageContext from './PageContext'\n\nexport default function App({\n  children,\n  initialPage,\n  resolveComponent,\n  resolveErrors,\n  transformProps,\n}) {\n  const [current, setCurrent] = useState({\n    component: null,\n    page: {},\n    key: null,\n  })\n\n  useEffect(() => {\n    Inertia.init({\n      initialPage,\n      resolveComponent,\n      resolveErrors,\n      transformProps,\n      swapComponent: async ({ component, page, preserveState }) => {\n        setCurrent(current => ({\n          component,\n          page,\n          key: preserveState ? current.key : Date.now(),\n        }))\n      },\n    })\n  }, [])\n\n  if (!current.component) {\n    return createElement(PageContext.Provider, { value: current.page }, null)\n  }\n\n  const renderChildren = children || (({ Component, props, key }) => {\n    const child = createElement(Component, { key, ...props })\n\n    if (typeof Component.layout === 'function') {\n      return Component.layout(child)\n    }\n\n    if (Array.isArray(Component.layout)) {\n      return Component.layout\n        .concat(child)\n        .reverse()\n        .reduce((children, Layout) => createElement(Layout, { children }))\n    }\n\n    return child\n  })\n\n  return createElement(\n    PageContext.Provider,\n    { value: current.page },\n    renderChildren({ Component: current.component, key: current.key, props: current.page.props }),\n  )\n}\n\nApp.displayName = 'Inertia'\n","import { hrefToUrl, Inertia, mergeDataIntoQueryString, shouldIntercept } from '@inertiajs/inertia'\nimport { createElement, useCallback, forwardRef } from 'react'\n\nconst noop = () => undefined\n\nexport default forwardRef(function InertiaLink({\n  children,\n  as = 'a',\n  data = {},\n  href,\n  method = 'get',\n  preserveScroll = false,\n  preserveState = null,\n  replace = false,\n  only = [],\n  headers = {},\n  onClick = noop,\n  onCancelToken = noop,\n  onBefore = noop,\n  onStart = noop,\n  onProgress = noop,\n  onFinish = noop,\n  onCancel = noop,\n  onSuccess = noop,\n  onError = noop,\n  ...props\n}, ref) {\n  const visit = useCallback(\n    (event) => {\n      onClick(event)\n\n      if (shouldIntercept(event)) {\n        event.preventDefault()\n\n        Inertia.visit(href, {\n          data,\n          method,\n          preserveScroll,\n          preserveState: preserveState ?? (method !== 'get'),\n          replace,\n          only,\n          headers,\n          onCancelToken,\n          onBefore,\n          onStart,\n          onProgress,\n          onFinish,\n          onCancel,\n          onSuccess,\n          onError,\n        })\n      }\n    },\n    [\n      data,\n      href,\n      method,\n      preserveScroll,\n      preserveState,\n      replace,\n      only,\n      headers,\n      onClick,\n      onCancelToken,\n      onBefore,\n      onStart,\n      onProgress,\n      onFinish,\n      onCancel,\n      onSuccess,\n      onError,\n    ],\n  )\n\n  as = as.toLowerCase()\n  method = method.toLowerCase()\n  const [url, _data] = mergeDataIntoQueryString(method, hrefToUrl(href), data)\n  href = url.href\n  data = _data\n\n  if (as === 'a' && method !== 'get') {\n    console.warn(`Creating POST/PUT/PATCH/DELETE <a> links is discouraged as it causes \"Open Link in New Tab/Window\" accessibility issues.\\n\\nPlease specify a more appropriate element using the \"as\" attribute. For example:\\n\\n<InertiaLink href=\"${href}\" method=\"${method}\" as=\"button\">...</InertiaLink>`)\n  }\n\n  return createElement(as, {\n    ...props,\n    ...as === 'a' ? { href } : {},\n    ref,\n    onClick: visit,\n  }, children)\n})\n","import { Inertia } from '@inertiajs/inertia'\nimport { useEffect, useState } from 'react'\n\nexport default function useRemember(initialState, key) {\n  const [state, setState] = useState(() => {\n    const restored = Inertia.restore(key)\n\n    return restored !== undefined ? restored : initialState\n  })\n\n  useEffect(() => {\n    Inertia.remember(state, key)\n  }, [state, key])\n\n  return [state, setState]\n}\n\nexport function useRememberedState(initialState, key) {\n  console.warn('The \"useRememberedState\" hook has been deprecated and will be removed in a future release. Use \"useRemember\" instead.')\n  return useRemember(initialState, key)\n}\n","import { Inertia } from '@inertiajs/inertia'\nimport { useCallback, useRef, useState } from 'react'\nimport useRemember from './useRemember'\n\nexport default function useForm(...args) {\n  const rememberKey = typeof args[0] === 'string' ? args[0] : null\n  const defaults = (typeof args[0] === 'string' ? args[1] : args[0]) || {}\n  const cancelToken = useRef(null)\n  const recentlySuccessfulTimeoutId = useRef(null)\n  const [data, setData] = rememberKey ? useRemember(defaults, `${rememberKey}:data`) : useState(defaults)\n  const [errors, setErrors] = rememberKey ? useRemember({}, `${rememberKey}:errors`) : useState({})\n  const [hasErrors, setHasErrors] = useState(false)\n  const [processing, setProcessing] = useState(false)\n  const [progress, setProgress] = useState(null)\n  const [wasSuccessful, setWasSuccessful] = useState(false)\n  const [recentlySuccessful, setRecentlySuccessful] = useState(false)\n  let transform = (data) => data\n\n  const submit = useCallback(\n    (method, url, options = {}) => {\n      const _options = {\n        ...options,\n        onCancelToken: (token) => {\n          cancelToken.current = token\n\n          if (options.cancelToken) {\n            return options.cancelToken(token)\n          }\n        },\n        onBefore: (visit) => {\n          setWasSuccessful(false)\n          setRecentlySuccessful(false)\n          clearTimeout(recentlySuccessfulTimeoutId.current)\n\n          if (options.onBefore) {\n            return options.onBefore(visit)\n          }\n        },\n        onStart: (visit) => {\n          setProcessing(true)\n\n          if (options.onStart) {\n            return options.onStart(visit)\n          }\n        },\n        onProgress: (event) => {\n          setProgress(event)\n\n          if (options.onProgress) {\n            return options.onProgress(event)\n          }\n        },\n        onSuccess: (page) => {\n          setProcessing(false)\n          setProgress(null)\n          setErrors({})\n          setHasErrors(false)\n          setWasSuccessful(true)\n          setRecentlySuccessful(true)\n          recentlySuccessfulTimeoutId.current = setTimeout(() => setRecentlySuccessful(false), 2000)\n\n          if (options.onSuccess) {\n            return options.onSuccess(page)\n          }\n        },\n        onError: (errors) => {\n          setProcessing(false)\n          setProgress(null)\n          setErrors(errors)\n          setHasErrors(true)\n\n          if (options.onError) {\n            return options.onError(errors)\n          }\n        },\n        onCancel: () => {\n          setProcessing(false)\n          setProgress(null)\n\n          if (options.onCancel) {\n            return options.onCancel()\n          }\n        },\n        onFinish: () => {\n          cancelToken.current = null\n\n          if (options.onFinish) {\n            return options.onFinish()\n          }\n        },\n      }\n\n      if (method === 'delete') {\n        Inertia.delete(url, { ..._options, data: transform(data) })\n      } else {\n        Inertia[method](url, transform(data), _options)\n      }\n    },\n    [data, setErrors],\n  )\n\n  return {\n    data,\n    setData(key, value) {\n      if (typeof key === 'string') {\n        setData({ ...data, [key]: value })\n      } else if (typeof key === 'function') {\n        setData(data => key(data))\n      } else {\n        setData(key)\n      }\n    },\n    errors,\n    hasErrors,\n    processing,\n    progress,\n    wasSuccessful,\n    recentlySuccessful,\n    transform(callback) {\n      transform = callback\n    },\n    reset(...fields) {\n      if (fields.length === 0) {\n        setData(defaults)\n      } else {\n        setData(\n          Object.keys(defaults)\n            .filter((key) => fields.includes(key))\n            .reduce((carry, key) => {\n              carry[key] = defaults[key]\n              return carry\n            }, {}),\n        )\n      }\n    },\n    clearErrors(...fields) {\n      setErrors(\n        Object.keys(errors).reduce(\n          (carry, field) => ({\n            ...carry,\n            ...(fields.length > 0 && !fields.includes(field) ? { [field]: errors[field] } : {}),\n          }),\n          {},\n        ),\n      )\n      setHasErrors(Object.keys(errors).length > 0)\n    },\n    submit,\n    get(url, options) {\n      submit('get', url, options)\n    },\n    post(url, options) {\n      submit('post', url, options)\n    },\n    put(url, options) {\n      submit('put', url, options)\n    },\n    patch(url, options) {\n      submit('patch', url, options)\n    },\n    delete(url, options) {\n      submit('delete', url, options)\n    },\n    cancel() {\n      if (cancelToken.current) {\n        cancelToken.current.cancel()\n      }\n    },\n  }\n}\n","import { useContext } from 'react'\nimport PageContext from './PageContext'\n\nexport default function usePage() {\n  const page = useContext(PageContext)\n\n  if (!page) {\n    throw new Error('usePage must be used within the Inertia component')\n  }\n\n  return page\n}\n"],"names":["pageContext","createContext","App","children","initialPage","resolveComponent","resolveErrors","transformProps","useState","component","page","key","current","setCurrent","useEffect","Inertia","init","swapComponent","preserveState","Date","now","createElement","PageContext","Provider","value","renderChildren","Component","child","props","layout","Array","isArray","concat","reverse","reduce","Layout","displayName","noop","forwardRef","ref","as","data","href","method","preserveScroll","replace","only","headers","onClick","onCancelToken","onBefore","onStart","onProgress","onFinish","onCancel","onSuccess","onError","visit","useCallback","event","shouldIntercept","preventDefault","toLowerCase","mergeDataIntoQueryString","hrefToUrl","console","warn","useRemember","initialState","restored","restore","undefined","state","setState","remember","args","rememberKey","defaults","cancelToken","useRef","recentlySuccessfulTimeoutId","setData","errors","setErrors","hasErrors","setHasErrors","processing","setProcessing","progress","setProgress","wasSuccessful","setWasSuccessful","recentlySuccessful","setRecentlySuccessful","transform","submit","url","options","_options","token","clearTimeout","setTimeout","callback","reset","fields","length","Object","keys","filter","includes","carry","clearErrors","field","get","post","put","patch","cancel","useContext","Error"],"mappings":"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"}